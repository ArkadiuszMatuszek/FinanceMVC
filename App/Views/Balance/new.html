{% extends "Balancebase.html" %}

{% block title %}Balance{% endblock %}

{% block footer %}

    <script src="/js/hideShowPassword.min.js"></script>
    <script src="/js/showBalance.js"></script>
    <script  language="JavaScript" type="text/javascript">
	
      
		$(document).ready(function() {
			var selectedOption = $("#selectDate").children("option:selected").val();
			if(selectedOption == 5)
			{
			$('#customDate').on('shown.bs.modal', function (e) {
			  console.log('Modal is successfully shown!');
			});
				$modal = $('#customDate');
				$modal.modal('show');
				
			}
			if(selectedOption == "fail")
			{
				$modal = $('#customDate');
				$modal.modal('show');
			}
			
			var d = new Date();
			var day = d.getDate();
			var month = d.getMonth() +1;
			var year = d.getFullYear();

			if(day <=9) day='0'+day;
			if(month <=9) month = '0' + month;

			$('#date').val(year+"-"+month+"-"+day);
			$('#date2').val(year+"-"+month+"-"+day);
			
		});
		
		$(document).ready(function() {
			$("#submitModal").click(function() {
				$("#formModal").submit();
			});
		});
		
		$('#year').text(new Date().getFullYear());
		
		
		
    </script>
	
	
   
}
	
{% endblock %}

{% block body %}


	
	<div class="ChooseDate">
		<div class="input-group form-group">
			<form name="formBalance" id="formBalance" action="/BalanceControllers/decide" method="post">
				<select class="form-control" name="periodOfTime" id="selectDate" onchange="this.form.submit()">  
				
					<option value="2" {% if option == 2 %} selected {% endif %}>Bieżacy miesiac</option>
					<option value="3" {% if option == 3 %} selected  {% endif %}>Poprzedni miesiąc</option>
					<option value="4" {% if option == 4 %} selected  {% endif %}>Bieżacy rok</option>
					<option value="5" {% if option == 5 %} selected  {% endif %}>Niestandardowy</option>
				</select>
			</form>
		</div>
	</div>	
	
	

	
	<!--MODAL -->
	<div class="modal" id="customDate">
	  <div class="modal-dialog">
		<div class="modal-content">
		
		  <div class="modal-header">
			<h5 class="modal-title">Choose range of dates</h5>
			
			<button class="close" data-dismiss="modal">&times;</button>
		  </div>
		  
		  <div class="modal-body">
			<form action="/BalanceControllers/showBalanceForPeriodOfTime" id="formModal" method="post">
			
				{% if balance.errors is not empty %}
					<p>Errors:</p>
					<ul>
						{% for error in balance.errors %}
							<li>{{ error }}</li>
						{% endfor %}
					</ul>
				{% endif %}
			
			  <div class="form-group">
				<label for="date">Od</label>
				<input class="form-control" type="date" min="2000-01-01" name="date1" id="date" required>
			  </div>

			  <div class="form-group">
				<label for="date">Do</label>
				<input class="form-control" type="date" min="2000-01-01" name="date2" id="date2" required>
			  </div>
			  
			</form>
		  </div>
		  
		  <div class="modal-footer">
			<button type="submit" class="btn btn-primary" data-dismiss="modal" form="form" id="submitModal">Akceptuj</button>
		  </div>
		  
		</div>
	  </div>
	</div>
	
	


	{% if incomes is empty %}
			<h1 >Brak przychodów dla danych dat.</h1>
			{% endif %}


{% if incomes is not empty %}
    

<div id='demo' style='display: none'>
<div class="limiter">
		<div class="container-table100">
			<div class="wrap-table100">
				<div class="table100">
				<h1>Incomes:</h1>
	<table>
	<thead>
    <tr>
        <th class="column1">Category</th>
        <th class="column1">Amount</th>
        <th class="column1">Comment</th>
        <th class="column1">Date</th>
    </tr>
    </thead>
    <tbody>
	<tr>
	
			
			
			{% for income in incomes %}
         <td class="column1">
		 
		 {% for showNameOfIncomesCattegories in showNameOfIncomesCattegories %}
			{% if income.income_category_assigned_to_user_id == showNameOfIncomesCattegories.id %}
				{{showNameOfIncomesCattegories.name}}
			{% endif %}
		 {% endfor %}
		 
		 </td>
       <td class="column1">{{ income.amount }} PLN</td>
        <td class="column1">
		{% if income.income_comment is not empty %}
		{{ income.income_comment }}
		{% else %}
		no comment
		{%endif%}
		</td>
		<td class="column1">{{ income.date_of_income }}</td>
		</tr>
		{% endfor %}
		
		
    </tbody>
</table>
	</div>
			</div>
		</div>
	</div>
	</div>
	
        <button class="btn btn1" type='button' onclick="toggleText()">Show/Hide incomes</button>
    
{% endif %}

		{% if incomes is empty %}
			
			{% endif %}
			
		{% if incomes is not empty %}
		
		<div id='demo1' style='display: none'>
				<div class="limiter">
		<div class="container-table100">
			<div class="wrap-table100">
				<div class="table100">
				<h1>Sum from each cattegory</h1>
	<table>
					<thead>
						<tr>
						<th class="column1">Category</th>
						<th class="column1">Amount</th>
		
						</tr>
					</thead>
					<tbody>
						
						{% for incomeCategory in incomesCategory %}
							<tr>
			
								
								<td class="column1">
								{% for showNameOfIncomesCattegories in showNameOfIncomesCattegories %}
									
									{% if incomeCategory.income_category_assigned_to_user_id == showNameOfIncomesCattegories.id %}
										{{showNameOfIncomesCattegories.name}}
									{% endif %}
									
								{% endfor %}
								
								
								</td>
								<td class="column1">{{incomeCategory.sum}} PLN</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
					</div>
			</div>
		</div>
	</div>
	</div>
	<button class="btn btn1" type='button' onclick="toggleText1()">Show/Hide sum from each cattegory</button>
			
		{% endif %}

		{% if expenses is empty %}
		
			<h1>Brak wydatków dla danych dat.</h1>
	
			{% endif %}
			
			
			{% if expenses is not empty %}
			

	
<div id='demo2' style='display: none'>
<div class="limiter">
		<div class="container-table100">
			<div class="wrap-table100">
				<div class="table100">
				<h1>Expenses</h1>
	<table>
	<thead>
    <tr>
        <th class="column1">Category</th>
        <th class="column1">Amount</th>
        <th class="column1">Comment</th>
        <th class="column1">Date</th>
    </tr>
    </thead>
    <tbody>
	<tr>
	

	
		{% for expense in expenses %}
         <td class="column1">
		 
		 {% for showNameOfExpensesCattegories in showNameOfExpensesCattegories %}
			
			{% if expense.expense_category_assigned_to_user_id == showNameOfExpensesCattegories.id %}
				{{showNameOfExpensesCattegories.name}}
			{% endif %}
		 
		 {% endfor %}
		 
		 
		 </td>
       <td class="column1">{{ expense.amount }} PLN</td>
        <td class="column1">
		{% if expense.expense_comment is not empty %}
		{{ expense.expense_comment }}
		{% else %}
		no comment
		{%endif%}
		
		</td>
		<td class="column1">{{ expense.date_of_expense }}</td>
		</tr>
		{% endfor %}
		
    </tbody>
</table>
	</div>
			</div>
		</div>
	</div>
	</div>
	
	<button class="btn btn1" type='button' onclick="toggleText2()">Show/Hide expenses</button>
	
{%endif%}



{% if expenses is not empty %}

	<div id='demo4' style='display: none'>		
<div class="limiter">
		<div class="container-table100">
			<div class="wrap-table100">
				<div class="table100">
				<h1>Sum from each cattegory</h1>
	<table>
					<thead>
						<tr>
							
							
							<th class="column1">Category</th>
							<th class="column1">Amount</th>
						</tr>
					</thead>
					<tbody>
						{% set number = 1 %}
						{% for expenseCategory in expensesCategory %}
							<tr>
							
								
								<td class="column1">
									 {% for showNameOfExpensesCattegories in showNameOfExpensesCattegories %}
								{% if expenseCategory.expense_category_assigned_to_user_id == showNameOfExpensesCattegories.id %}
		

		{{showNameOfExpensesCattegories.name}}
		 {% endif %}
		 
		 {% endfor %}
							
								
								</td>
								<td class="column1">{{expenseCategory.sum}} PLN</td>
							</tr>
							
						{% endfor %}
					</tbody>
				</table>
	</div>
			</div>
		</div>
	</div>
	</div>
		 <button class="btn btn1" type='button' onclick="toggleText4()">Show/Hide sum from each cattegory</button>
{% endif %}

	
		{% if incomes is not empty %}
		<h3 class="text-center py-2" >Income's total: {% for saldoIncome in saldoIncomes %} {{saldoIncome.sum}} zł. {% endfor %}</h3>
		 {% endif %}
		
		{% if expenses is not empty %}
		<h3 class="text-center py-2" >Expense's total: {% for saldoExpense in saldoExpenses %} {{saldoExpense.sum}} zł. {% endfor %}</h3>

		 {% endif %}
	
{% endblock %}